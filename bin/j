#!/bin/bash

function j() {
    local SEARCHDIRS=(
        ${GOPATH}/src/*/*
        ${HOME}/git
    )

    if [ $# -lt 1 ]; then
        echo "j - Jump to the directory of the named project"
        echo
        echo "Usage: j <name>"
        echo
        return 1
    fi

    DIR=($(find ${SEARCHDIRS[@]} -type d -name "*$@*" -depth 1))
    case ${#DIR[@]} in
    0)
        return
        ;;
    1)
        # Do nothing - we know the dir we want now.
        ;;
    *)
        # Check if we have any exact matches.
        CANDIDATE=""
        for CHOICE in ${DIR[@]}; do
            if [ "${CHOICE##*/}" == "$@" ]; then
                if [ -n "$CANDIDATE" ]; then
                    break
                fi
                CANDIDATE=$CHOICE
            fi
        done

        if [ -n "$CANDIDATE" ]; then
            # Multiple matches, but one was an exact match. Use it.
            DIR=$CANDIDATE
        else
            # Multiple choices, but no exact match - prompt.
            select CHOICE in ${DIR[@]}; do
                DIR=$CHOICE
                break
            done
        fi
        ;;
    esac

    echo "--> $DIR"
    cd $DIR
}
